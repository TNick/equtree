<%-# ====================================================================== -%>
<%-# ---------------------------------------------------------------------- -%>
<%-#                                                                        -%>
<%-#  \date			May 2013                                                -%>
<%-#  \author		TNick                                                   -%>
<%-#                                                                        -%>
<%-#  \brief		Partial view for creating directories                   -%>
<%-#                                                                        -%>
<%-#                                                                        -%>
<%-# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~- %>
<%-# Please read COPYING and README files in root folder                    -%>
<%-# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -%>
<%-#                                                                        -%>
<%-# ---------------------------------------------------------------------- -%>
<%-# ====================================================================== -%>
<%-#                                                                        -%>
<%-#                                                                        -%>
<%-#                                                                        -%>
<%-#                                                                        -%>
<%-#  CONTENT    ---------------------------------------------------------- -%>
  

<div class="directory-label">
  Directories
</div>

<div class="directory_tree" id="directory_tree">
    <%= nested_directories( @directories ) %>
</div>

<script>
$(function() {
    var dt = $("#directory_tree")
    dt.jstree({
        "themes" :  { 
                    "theme" : "classic", 
                    "dots" : "true", 
                    "icons" : "true" 
               },
        "plugins": [ "ui", "html_data", "themes" ]
    });
    dt.bind("select_node.jstree", function (event, data) {
           var elem = document.getElementById("dir_selectedid");
           elem.value = data.rslt.obj.attr("id");
    });
    setTimeout(function () { dt.jstree("set_focus"); }, 100);

});
</script>


<hr/>

<%= form_for(@directory, :html => { :style => 'display: inline;' }) do |f| %>

  <%= render 'shared/error_messages', object: f.object %>
  
  <div class="field">
    <%= f.text_field :name, placeholder: "Directory name" %>
  </div>
  <%= f.submit "Top", class: "btn", :name => "top" %>
  <%= f.submit "Create", class: "btn  btn-primary", :name => "create" %>
  <%= f.submit "Delete", class: "btn", :name => "del" %>
  <%= f.submit "Change", class: "btn", :name => "chg" %>
  <div style="display:inline">
    <%= radio_button_tag(:fstype, "dir", checked = true, ) %>
    <%= label_tag(:fstype_dir, "Directory",:style => "display:inline") %>
    <%= radio_button_tag(:fstype, "file", checked = false) %>
    <%= label_tag(:fstype_file, "File", :style => "display:inline") %>
  </div>
  <%= hidden_field_tag :dir_selectedid %>
<% end %>

<%-#  CONTENT    ========================================================== -%>
<%-#                                                                        -%>
<%-#                                                                        -%>
<%-#                                                                        -%>
<%-#                                                                        -%>
<%-# ---------------------------------------------------------------------- -%>
<%-# ====================================================================== -%>
